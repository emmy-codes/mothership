<!DOCTYPE html>
<html lang="en">

<head>
    <title>Heatmap Calendar Test</title>
    <meta charset="UTF-8">
    <meta name="viewpoint" content="width=device-width, initial-scale=1.0">
</head>

<body>
    <style>
        .weekdays {
            display: grid;
            grid-template-columns: repeat(1, 1fr);
        }

        .unused-day {
            background-color: #c6c6c6;
        }

        .grid-box {
            display: grid;
            grid-template-rows: repeat(7, 1fr);
            grid-template-columns: repeat(8, 1fr);
        }

        .grid-box>div {
            border: 1px solid #000;
        }

        .weekdays {
            line-height: 25px;
        }

        .grid-box>div>p {
            /* > selects the children*/
            visibility: hidden;
        }

        .actual-map {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
        }
    </style>
    <div class="heatmap">

        <div class="month">
            <h1> Nov 2020 </h1>
        </div>

        <div class="actual-map">
            <div class="grid-box">
                <div id="monday" class="dayname">Mo</div>
                <div class="day unused-day"><p>1</p></div>
                <div class="day" id="daynumber-2"><p>1</p></div>
                <div class="day" id="daynumber-9"><p>1</p></div>
                <div class="day" id="daynumber-16"><p>1</p></div>
                <div class="day" id="daynumber-23"><p>1</p></div>
                <div class="day" id="daynumber-30"><p>1</p></div>
                <div class="day unused-day"><p>1</p></div>
                <div id="tuesday" class="dayname">Tu</div>
                <div class="day unused-day"><p>1</p></div>
                <div class="day" id="daynumber-3"><p>1</p></div>
                <div class="day" id="daynumber-10"><p>1</p></div>
                <div class="day" id="daynumber-17"><p>1</p></div>
                <div class="day" id="daynumber-24"><p>1</p></div>
                <div class="day unused-day"><p>1</p></div>
                <div class="day unused-day"><p>1</p></div>
                <div id="wednesday" class="dayname">We</div>
                <div class="day unused-day"><p>1</p></div>
                <div class="day" id="daynumber-4"><p>1</p></div>
                <div class="day" id="daynumber-11"><p>1</p></div>
                <div class="day" id="daynumber-18"><p>1</p></div>
                <div class="day" id="daynumber-25"><p>1</p></div>
                <div class="day unused-day"><p>1</p></div>
                <div class="day unused-day"><p>1</p></div>
                <div id="thursday" class="dayname">Th</div>
                <div class="day unused-day"><p>1</p></div>
                <div class="day" id="daynumber-5"><p>1</p></div>
                <div class="day" id="daynumber-12"><p>1</p></div>
                <div class="day" id="daynumber-19"><p>1</p></div>
                <div class="day" id="daynumber-26"><p>1</p></div>
                <div class="day unused-day"><p>1</p></div>
                <div class="day unused-day"><p>1</p></div>
                <div id="friday" class="dayname">Fr</div>
                <div class="day unused-day"><p>1</p></div>
                <div class="day" id="daynumber-6"><p>1</p></div>
                <div class="day" id="daynumber-13"><p>1</p></div>
                <div class="day" id="daynumber-20"><p>1</p></div>
                <div class="day" id="daynumber-27"><p>1</p></div>
                <div class="day unused-day"><p>1</p></div>
                <div class="day unused-day"><p>1</p></div>
                <div id="saturday" class="dayname">Sa</div>
                <div class="day unused-day"><p>1</p></div>
                <div class="day" id="daynumber-7"><p>1</p></div>
                <div class="day" id="daynumber-14"><p>1</p></div>
                <div class="day" id="daynumber-21"><p>1</p></div>
                <div class="day" id="daynumber-28"><p>1</p></div>
                <div class="day unused-day"><p>1</p></div>
                <div class="day unused-day"><p>1</p></div>
                <div id="sunday" class="dayname">Su</div>
                <div class="day" id="daynumber-1"><p>1</p></div>
                <div class="day" id="daynumber-8"><p>1</p></div>
                <div class="day" id="daynumber-15"><p>1</p></div>
                <div class="day" id="daynumber-22"><p>1</p></div>
                <div class="day" id="daynumber-29"><p>1</p></div>
                <div class="day unused-day"><p>1</p></div>
                <div class="day unused-day"><p>1</p></div>
            </div>
        </div>
    </div>

    <script>

        window.onload = loadHeatmap; //do js when html is done

        const colorMapping = {
            1: "#F2FF83",
            2: "#BDFF77",
            3: "#9CFF32",
            4: "#6CD100",
            5: "#509B00"
        }

        function insertAfter(oldElement, newElement) {  //after oldElement insert newElement
            oldElement.parentNode.insertBefore(newElement, oldElement.nextSibling);
        }

        // just a test: remove this later
        function testAddLocalStorage() {
            const userData = {
                calendar: [
                    { numberOfHabits: 1 },
                    { numberOfHabits: 5 },
                    { numberOfHabits: 3 },
                    { numberOfHabits: 4 },
                    { numberOfHabits: 2 },
                    { numberOfHabits: 3 },
                    { numberOfHabits: 2 },
                    { numberOfHabits: 5 },
                    { numberOfHabits: 1 },
                    { numberOfHabits: 5 },
                    { numberOfHabits: 3 },
                    { numberOfHabits: 4 },
                    { numberOfHabits: 2 },
                    { numberOfHabits: 3 },
                    { numberOfHabits: 2 },
                    { numberOfHabits: 5 },
                    { numberOfHabits: 1 },
                    { numberOfHabits: 5 },
                    { numberOfHabits: 3 },
                    { numberOfHabits: 4 },
                    { numberOfHabits: 2 },
                    { numberOfHabits: 3 },
                    { numberOfHabits: 2 },
                    { numberOfHabits: 5 },
                    { numberOfHabits: 1 },
                    { numberOfHabits: 5 },
                    { numberOfHabits: 3 },
                    { numberOfHabits: 4 },
                    { numberOfHabits: 2 },
                    { numberOfHabits: 3 },
                    { numberOfHabits: 2 },
                    { numberOfHabits: 5 },
                    { numberOfHabits: 1 },
                    { numberOfHabits: 5 },
                    { numberOfHabits: 3 },
                    { numberOfHabits: 4 },
                    { numberOfHabits: 2 },
                    { numberOfHabits: 3 },
                    { numberOfHabits: 2 },
                    { numberOfHabits: 5 },
                    { numberOfHabits: 1 },
                    { numberOfHabits: 5 },
                    { numberOfHabits: 3 },
                    { numberOfHabits: 4 },
                    { numberOfHabits: 2 },
                    { numberOfHabits: 3 },
                    { numberOfHabits: 2 },
                    { numberOfHabits: 5 },
                ]
            }

            localStorage.setItem('locallyStored', JSON.stringify(userData))
        }

        function loadHeatmap() {
            testAddLocalStorage(); //remove this later
            let userData = localStorage.getItem('locallyStored');
            if (!userData) { // if user data does not exist
                alert("The heatmap found no data in local storage. :)");
                return;
            }

            userData = JSON.parse(localStorage.getItem('locallyStored'));
            userData.calendar.forEach(function (day, index) {
                const currentDayNumber = index + 1;
                const numberOfHabits = day.numberOfHabits;

                if (numberOfHabits < 1 || numberOfHabits > 5) {
                    alert("Number of habits is forbidden value.");
                    return;
                }

                let colorCode = colorMapping[numberOfHabits];
                const currentDayElement = document.getElementById(`daynumber-${currentDayNumber}`); // currentDayNumber will depend on what day we are at.
                currentDayElement.style.backgroundColor = colorCode;
            });

        }

    </script>
</body>

</html>